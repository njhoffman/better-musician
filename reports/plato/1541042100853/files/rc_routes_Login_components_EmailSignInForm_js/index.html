<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - rc/routes/Login/components/EmailSignInForm.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>rc/routes/Login/components/EmailSignInForm.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">78.34</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">158</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">26.25</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.30</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">import React from &#039;react&#039;;
import PropTypes from &#039;prop-types&#039;;
import { reduxForm } from &#039;redux-form&#039;;
import { connect } from &#039;react-redux&#039;;
import { Column } from &#039;react-foundation&#039;;
import withStyles from &#039;@material-ui/core/styles/withStyles&#039;;
import { Divider, Typography } from &#039;@material-ui/core&#039;;
import ExitToAppIcon from &#039;@material-ui/icons/ExitToApp&#039;;

import Button from &#039;components/Button&#039;;
import FormField, { FormRow } from &#039;components/Field&#039;;
import validate from &#039;utils/validate&#039;;
import { changedFields } from &#039;selectors/form&#039;;
import { emailSignIn } from &#039;actions/auth/signin&#039;;
import { init as initLog } from &#039;shared/logger&#039;;

const { error } = initLog(&#039;emailSignInForm&#039;);

const styles = (theme) =&gt; ({
  divider: {
    margin: &#039;20px 0px 5px 0px&#039;
  },
  errorTitle: {
    color: &#039;red&#039;
  },
  errorMessage: {
  }
});

const getEndpoint = ({ endpoint, config }) =&gt; (
  endpoint || config.auth.currentEndpointKey || config.auth.defaultEndpointkey
);

const getFormValues = (formKeys) =&gt; {
  const formData = {};
  formKeys.forEach((key) =&gt; {
    if (!formData[key]) {
      formData[key] = document.querySelector(`input[name=&quot;${key}&quot;]`).value || &#039;&#039;;
    }
  });
  return formData;
};

const handleSubmit = (event, props) =&gt; {
  event.preventDefault();

  const formData = getFormValues([&#039;email-sign-in-email&#039;, &#039;email-sign-in-password&#039;]);
  // TODO: dev/production check
  props.dispatch(props.emailSignIn(formData, getEndpoint(props)))
    .then(() =&gt; props.next(props.dispatch))
    .catch((e) =&gt; { error(e); });
};

const EmailSignInForm = ({
  classes,
  isFetching,
  errors,
  loginForm,
  isSignedIn,
  ...props
}) =&gt; (
  &lt;form&gt;
    &lt;FormRow&gt;
      &lt;Column&gt;
        {errors &amp;&amp; [].concat(errors).map((err, i) =&gt; (
          &lt;div key={err.name}&gt;
            &lt;Typography variant=&#039;body1&#039; className={classes.errorTitle}&gt;
              {err &amp;&amp; err.name ? err.name : &#039;&#039;}
              {err &amp;&amp; err.err ? err.err : &#039;&#039;}
            &lt;/Typography&gt;
            &lt;Typography variant=&#039;caption&#039; className={classes.errorMessage}&gt;
              {err &amp;&amp; err.message ? err.message : &#039;&#039;}
              {err &amp;&amp; err.reason ? err.reason : &#039;&#039;}
            &lt;/Typography&gt;
          &lt;/div&gt;
        ))}
      &lt;/Column&gt;
    &lt;/FormRow&gt;
    &lt;FormRow small={10} medium={8}&gt;
      &lt;FormField
        type=&#039;text&#039;
        label=&#039;Email&#039;
        name=&#039;email-sign-in-email&#039;
        className=&#039;email-sign-in-email&#039;
        disabled={isSignedIn}
      /&gt;
    &lt;/FormRow&gt;
    &lt;FormRow small={10} medium={8}&gt;
      &lt;FormField
        type=&#039;text&#039;
        label=&#039;Password&#039;
        name=&#039;email-sign-in-password&#039;
        className=&#039;email-sign-in-password&#039;
        disabled={isSignedIn}
      /&gt;
    &lt;/FormRow&gt;
    &lt;Divider className={classes.divider} /&gt;
    &lt;FormRow small={10}&gt;
      &lt;Column centerOnSmall&gt;
        &lt;Button
          label=&#039;Sign In&#039;
          primary
          icon={&lt;ExitToAppIcon /&gt;}
          disabled={Boolean(isSignedIn || loginForm.syncErrors || isFetching)}
          loading={isFetching}
          onClick={(e) =&gt; handleSubmit(e, props)}
        /&gt;
      &lt;/Column&gt;
    &lt;/FormRow&gt;
  &lt;/form&gt;
);

const validateFields = {
  &#039;email-sign-in-email&#039;: [
    [&#039;required&#039;, &#039;Required&#039;],
    [&#039;isEmail&#039;, &#039;Invalid Email&#039;]
  ],
  &#039;email-sign-in-password&#039;: [
    [&#039;required&#039;, &#039;Required&#039;],
  ]
};

EmailSignInForm.propTypes = {
  classes:     PropTypes.instanceOf(Object).isRequired,
  config:      PropTypes.instanceOf(Object).isRequired,
  loginForm:   PropTypes.instanceOf(Object),
  isFetching:  PropTypes.bool.isRequired,
  errors:      PropTypes.arrayOf(PropTypes.object),
  dispatch:    PropTypes.func.isRequired,
  endpoint:    PropTypes.string,
  next:        PropTypes.func,
  emailSignIn: PropTypes.func.isRequired,
  isSignedIn:  PropTypes.bool.isRequired
};

EmailSignInForm.defaultProps = {
  next:      () =&gt; {},
  errors:    [],
  endpoint:  null,
  loginForm: {}
};

const mapStateToProps = (state) =&gt; ({
  config:      state.config,
  isSignedIn:  state.user.isSignedIn,
  loginForm:   state.form.login,
  errors:      state.api.auth.login.errors || [],
  syncErrors:  state.form.login &amp;&amp; state.form.login.syncErrors,
  isFetching:  state.api.auth.login.loading,
  changed:     changedFields(state.form.login),
  emailSignIn
});

export default connect(mapStateToProps)(withStyles(styles)(reduxForm({
  form: &#039;login&#039;,
  validate: validate(validateFields)
})(EmailSignInForm)));
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
