<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - rc/actions/auth.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato.css" rel="stylesheet" type="text/css">
  <link href="../../assets/css/plato-file.css" rel="stylesheet" type="text/css">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="https://github.com/the-simian/es6-plato">ES6 Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
      <li class="active">
        <a href="display.html">Summary Display</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>rc/actions/auth.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">80.69</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">106</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">17.10</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">1.03</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">import {
  getSignOutUrl,
  destroySession,
  getEmailSignInUrl,
  getCurrentEndpointKey
} from &#039;utils/sessionStorage&#039;;

import fetch, { parseResponse } from &#039;utils/fetch&#039;;

export const AUTHENTICATE_START    = &#039;AUTHENTICATE_START&#039;;
export const AUTHENTICATE_COMPLETE = &#039;AUTHENTICATE_COMPLETE&#039;;
export const AUTHENTICATE_ERROR    = &#039;AUTHENTICATE_ERROR&#039;;

export const SET_ENDPOINT_KEYS = &#039;SET_ENDPOINT_KEYS&#039;;
export const STORE_CURRENT_ENDPOINT_KEY = &#039;STORE_CURRENT_ENDPOINT_KEY&#039;;

export const CONFIGURE_START = &#039;CONFIGURE_START&#039;;
export const CONFIGURE_COMPLETE = &#039;CONFIGURE_COMPLETE&#039;;

export const EMAIL_SIGN_IN_START       = &#039;EMAIL_SIGN_IN_START&#039;;
export const EMAIL_SIGN_IN_COMPLETE    = &#039;EMAIL_SIGN_IN_COMPLETE&#039;;
export const EMAIL_SIGN_IN_ERROR       = &#039;EMAIL_SIGN_IN_ERROR&#039;;
export const EMAIL_SIGN_IN_FORM_UPDATE = &#039;EMAIL_SIGN_IN_FORM_UPDATE&#039;;

export const SIGN_OUT_START    = &#039;SIGN_OUT_START&#039;;
export const SIGN_OUT_COMPLETE = &#039;SIGN_OUT_COMPLETE&#039;;
export const SIGN_OUT_ERROR    = &#039;SIGN_OUT_ERROR&#039;;

export const configureStart = () =&gt; ({ type: CONFIGURE_START });
export const configureComplete = (config) =&gt; ({ type: CONFIGURE_COMPLETE, payload: config });

export const authenticateStart = () =&gt; ({ type: AUTHENTICATE_START });
export const authenticateComplete = (user) =&gt; ({ type: AUTHENTICATE_COMPLETE, payload: user });
export const authenticateError = (errors) =&gt; ({ type: AUTHENTICATE_ERROR, payload: errors });

export const setEndpointKeys = (endpoints, currentEndpointKey, defaultEndpointKey) =&gt; ({
  type: SET_ENDPOINT_KEYS, endpoints, currentEndpointKey, defaultEndpointKey
});

export const storeCurrentEndpointKey = (currentEndpointKey) =&gt; ({
  type: STORE_CURRENT_ENDPOINT_KEY, currentEndpointKey
});

export const emailSignInFormUpdate = (endpoint, key, value) =&gt;
  ({ type: EMAIL_SIGN_IN_FORM_UPDATE, endpoint, key, value });

export const emailSignInStart = (endpoint) =&gt;
  ({ type: EMAIL_SIGN_IN_START, endpoint });

export const emailSignInComplete = (endpoint, user) =&gt;
  ({ type: EMAIL_SIGN_IN_COMPLETE, user, endpoint });

export const emailSignInError = (endpoint, errors) =&gt;
  ({ type: EMAIL_SIGN_IN_ERROR, errors, endpoint });

export const emailSignIn = (body, endpointKey) =&gt; (dispatch) =&gt; {
  // save previous endpoint key in case of failure
  const prevEndpointKey = getCurrentEndpointKey();

  // necessary for fetch to recognize the response as an api request
  setCurrentEndpointKey(endpointKey);
  const currentEndpointKey = getCurrentEndpointKey();

  dispatch(storeCurrentEndpointKey(currentEndpointKey));
  dispatch(emailSignInStart(currentEndpointKey));

  return fetch(getEmailSignInUrl(currentEndpointKey), {
    headers: {
      &#039;Accept&#039;: &#039;application/json&#039;,
      &#039;Content-Type&#039;: &#039;application/json&#039;
    },
    method: &#039;post&#039;,
    body: JSON.stringify(body)
  }).then(parseResponse)
    .then((user) =&gt; dispatch(emailSignInComplete(currentEndpointKey, user)))
    .catch((errors) =&gt; {
      // revert endpoint key to what it was before failed request
      setCurrentEndpointKey(prevEndpointKey);
      dispatch(storeCurrentEndpointKey(prevEndpointKey));
      dispatch(emailSignInError(currentEndpointKey, errors));
      throw errors;
    });
};

export const signOutStart = (endpoint) =&gt; ({ type: SIGN_OUT_START, endpoint });
export const signOutComplete = (endpoint, user) =&gt; ({ type: SIGN_OUT_COMPLETE, user, endpoint });
export const signOutError = (endpoint, errors) =&gt; ({ type: SIGN_OUT_ERROR, endpoint, errors });

export const signOut = (endpoint) =&gt; (dispatch) =&gt; {
  dispatch(signOutStart(endpoint));

  return fetch(getSignOutUrl(endpoint), { method: &#039;delete&#039; })
    .then(parseResponse)
    .then((user) =&gt; {
      dispatch(signOutComplete(endpoint, user));
      dispatch(storeCurrentEndpointKey(null));
      destroySession();
    })
    .catch(({ errors }) =&gt; {
      dispatch(signOutError(endpoint, errors));
      dispatch(storeCurrentEndpointKey(null));
      destroySession();
      throw errors;
    });
};
</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
