{"version":3,"sources":["src/store/auth/utils/parse-endpoint-config.js"],"names":["parseEndpointConfig","C","defaultEndpoint","apiUrl","signOutPath","emailSignInPath","emailRegistrationPath","accountUpdatePath","accountDeletePath","passwordResetPath","passwordUpdatePath","tokenValidationPath","authProviderPaths","github","facebook","google","getFirstObjectKey","obj","key","endpoint","defaultEndpointKey","constructor","Array","INITIAL_CONFIG_KEY","defaultConfig","currentEndpoint","i","length","configName"],"mappings":";;;;;kBA4BwBA,mB;;AA5BxB;;IAAYC,C;;AACZ;;;;;;;;AAEA;AACA,IAAMC,kBAAkB;AACtBC,UAAuB,MADD;AAEtBC,eAAuB,gBAFD;AAGtBC,mBAAuB,eAHD;AAItBC,yBAAuB,OAJD;AAKtBC,qBAAuB,OALD;AAMtBC,qBAAuB,OAND;AAOtBC,qBAAuB,gBAPD;AAQtBC,sBAAuB,gBARD;AAStBC,uBAAuB,sBATD;;AAWtBC,qBAAmB;AACjBC,YAAW,cADM;AAEjBC,cAAW,gBAFM;AAGjBC,YAAW;AAHM;AAXG,CAAxB;;AAkBA,SAASC,iBAAT,CAA4BC,GAA5B,EAAiC;AAC/B,OAAK,IAAIC,GAAT,IAAgBD,GAAhB,EAAqB;AACnB,WAAOC,GAAP;AACD;AACF;;AAEc,SAASlB,mBAAT,CAA6BmB,QAA7B,EAAkE;AAAA,MAA3BC,kBAA2B,uEAAN,IAAM;;AAC/E;AACA,MAAID,SAASE,WAAT,KAAyBC,KAA7B,EAAoC;AAClC;AACA;AACAF,yBAAqBnB,EAAEsB,kBAAvB;;AAEA;AACA,QAAIC,gBAAgB,EAApB;AACAA,kBAAcJ,kBAAd,IAAoCD,QAApC;;AAEA;AACAA,eAAW,CAACK,aAAD,CAAX;AACD;;AAED,MAAIC,kBAAkB,EAAtB;;AAEA;AACA,OAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIP,SAASQ,MAA7B,EAAqCD,GAArC,EAA0C;AACxC,QAAIE,aAAaZ,kBAAkBG,SAASO,CAAT,CAAlB,CAAjB;;AAEA;AACA,QAAI,CAACN,kBAAL,EAAyB;AACvBA,2BAAqBQ,UAArB;AACD;;AAED;AACAH,oBAAgBG,UAAhB,IAA8B,sBAC5B,EAD4B,EACxB1B,eADwB,EACPiB,SAASO,CAAT,EAAYE,UAAZ,CADO,CAA9B;AAGD;;AAED,SAAO,EAACR,sCAAD,EAAqBK,gCAArB,EAAP;AACD","file":"parse-endpoint-config.js","sourceRoot":"/home/vagrant/projects/instrumental","sourcesContent":["import * as C from \"./constants\";\r\nimport extend from \"extend\";\r\n\r\n// base endpoint that other endpoints extend from\r\nconst defaultEndpoint = {\r\n  apiUrl:                \"/api\",\r\n  signOutPath:           \"/auth/sign_out\",\r\n  emailSignInPath:       \"/auth/sign_in\",\r\n  emailRegistrationPath: \"/auth\",\r\n  accountUpdatePath:     \"/auth\",\r\n  accountDeletePath:     \"/auth\",\r\n  passwordResetPath:     \"/auth/password\",\r\n  passwordUpdatePath:    \"/auth/password\",\r\n  tokenValidationPath:   \"/auth/validate_token\",\r\n\r\n  authProviderPaths: {\r\n    github:    \"/auth/github\",\r\n    facebook:  \"/auth/facebook\",\r\n    google:    \"/auth/google_oauth2\"\r\n  }\r\n};\r\n\r\nfunction getFirstObjectKey (obj) {\r\n  for (var key in obj) {\r\n    return key;\r\n  }\r\n};\r\n\r\nexport default function parseEndpointConfig(endpoint, defaultEndpointKey = null) {\r\n  // normalize so opts is always an array of objects\r\n  if (endpoint.constructor !== Array) {\r\n    // single config will always be called 'default' unless set\r\n    // by previous session\r\n    defaultEndpointKey = C.INITIAL_CONFIG_KEY;\r\n\r\n    // config should look like {default: {...}}\r\n    var defaultConfig = {};\r\n    defaultConfig[defaultEndpointKey] = endpoint;\r\n\r\n    // endpoint should look like [{default: {...}}]\r\n    endpoint = [defaultConfig];\r\n  }\r\n\r\n  let currentEndpoint = {};\r\n\r\n  // iterate over config items, extend each from defaults\r\n  for (var i = 0; i < endpoint.length; i++) {\r\n    var configName = getFirstObjectKey(endpoint[i]);\r\n\r\n    // set first as default config\r\n    if (!defaultEndpointKey) {\r\n      defaultEndpointKey = configName;\r\n    }\r\n\r\n    // save config to `configs` hash\r\n    currentEndpoint[configName] = extend(\r\n      {}, defaultEndpoint, endpoint[i][configName]\r\n    );\r\n  }\r\n\r\n  return {defaultEndpointKey, currentEndpoint};\r\n}\r\n"]}